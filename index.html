<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- iOS Web App é…ç½® -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="å­¦ä¹ ä¹å›­">
    <!-- åŠ¨æ€ SVG Favicon: ç¬‘è„¸+ä¹¦æœ¬ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ˜Š</text></svg>">
    <title>å®‰å®‰çš„å­¦ä¹ ä¹å›­</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zcool+KuaiLe&display=swap');

        :root {
            /* æå–è‡ªæµ·æŠ¥çš„é…è‰² */
            --poster-blue: #00A1E9;   /* æ ‡é¢˜è“ */
            --poster-green: #7CB342;  /* è‰åœ°ç»¿ */
            --poster-yellow: #FFEB3B; /* é†’ç›®é»„ */
            --poster-text: #546E7A;   /* æ·±ç°è“æ–‡å­— */
            --bg-white: #FFFFFF;
            --card-shadow: rgba(0, 161, 233, 0.15);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: "Zcool KuaiLe", "Comic Sans MS", cursive, sans-serif;
            background-color: #FAFBFD; /* ææ·¡çš„è“ç°è‰²èƒŒæ™¯ */
            height: 100vh;
            display: flex;
            overflow: hidden;
            user-select: none;
            color: var(--poster-text);
        }

        /* --- é¡¶éƒ¨å½©æ——è£…é¥° (çº¯CSSç»˜åˆ¶) --- */
        .bunting-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 30px;
            display: flex;
            z-index: 100;
            pointer-events: none;
        }
        .flag {
            flex: 1;
            height: 100%;
            background: var(--color);
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            opacity: 0.8;
        }
        .flag:nth-child(odd) { transform: translateY(-5px); } /* é”™è½æ„Ÿ */

        /* --- èƒŒæ™¯è£…é¥° --- */
        .bg-pattern {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background-image: 
                radial-gradient(var(--poster-yellow) 15%, transparent 16%),
                radial-gradient(var(--poster-blue) 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            opacity: 0.1;
        }

        /* å·¦ä¾§ä¾§è¾¹æ  */
        .sidebar {
            width: 130px;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 60px; /* å¢åŠ é¡¶éƒ¨ç•™ç™½é¿å¼€å½©æ—— */
            box-shadow: 4px 0 20px var(--card-shadow);
            z-index: 10;
            flex-shrink: 0;
            border-right: 4px solid var(--poster-yellow);
            height: 100vh; /* ç¡®ä¿å æ»¡å…¨å±é«˜åº¦ */
            box-sizing: border-box; /* åŒ…å«padding */
        }

        .user-profile {
            text-align: center;
            margin-bottom: 20px; /* å‡å°é—´è· */
            cursor: pointer;
            transition: transform 0.2s;
            flex-shrink: 0; /* é˜²æ­¢å¤´åƒè¢«å‹ç¼© */
        }
        .user-profile:hover { transform: scale(1.05); }

        .avatar {
            width: 80px;
            height: 80px;
            background: var(--poster-blue);
            border-radius: 50%;
            margin: 0 auto 10px;
            border: 4px solid white;
            outline: 4px solid var(--poster-yellow);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .username-display {
            font-size: 1.2rem;
            color: var(--poster-blue);
            font-weight: bold;
            padding: 2px 10px;
            border-radius: 10px;
            background: rgba(0, 161, 233, 0.1);
        }

        .grade-list {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            padding: 10px 0 40px 0; /* å¢åŠ åº•éƒ¨paddingï¼Œé˜²æ­¢æœ€åä¸€ä¸ªè¢«é®æŒ¡ */
            overflow-y: auto; /* å…è®¸åˆ—è¡¨æ»šåŠ¨ */
            flex: 1; /* å æ»¡å‰©ä½™ç©ºé—´ */
            
            /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none;  /* IE 10+ */
        }
        .grade-list::-webkit-scrollbar { 
            display: none; /* Chrome/Safari */
        }

        /* æ¨¡ä»¿æµ·æŠ¥ä¸­çš„åœ†å½¢/èƒ¶å›Šå¾½ç«  */
        .grade-item {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1.2rem;
            color: white;
            background: #CFD8DC; /* æœªé€‰ä¸­ç°è‰² */
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .grade-item span {
            z-index: 2;
            text-align: center;
            line-height: 1.2;
        }

        /* é€‰ä¸­æ€ï¼šæ¨¡ä»¿æµ·æŠ¥å·¦ä¸‹è§’çš„å¤§é»„åœ† */
        .grade-item.active {
            background: var(--poster-yellow);
            color: var(--poster-blue);
            transform: scale(1.2);
            box-shadow: 0 6px 0 #FBC02D;
            font-weight: bold;
            z-index: 5;
        }
        
        /* è£…é¥°æ€§çš„å°ä¸‰è§’ */
        .grade-item.active::after {
            content: '';
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            border-left: 10px solid var(--poster-yellow);
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
        }

        /* å³ä¾§å†…å®¹åŒº */
        .content {
            flex: 1;
            padding: 40px 40px 20px 40px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        header {
            margin-bottom: 40px;
            margin-top: 20px;
            border-bottom: 3px dashed var(--poster-green);
            padding-bottom: 15px;
        }

        h1 {
            margin: 0;
            color: var(--poster-blue);
            font-size: 2.5rem;
            letter-spacing: 2px;
        }

        p.subtitle {
            margin: 5px 0 0 0;
            color: var(--poster-green);
            font-size: 1.2rem;
        }

        /* App ç½‘æ ¼ */
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 30px;
        }

        .app-card {
            background: white;
            border-radius: 25px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            border: 4px solid white; /* é»˜è®¤ç™½è¾¹ */
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-decoration: none;
            color: inherit;
            position: relative;
            overflow: hidden;
        }

        /* æ¨¡ä»¿æµ·æŠ¥é£æ ¼çš„ç²—è¾¹æ¡† */
        .app-card:hover {
            transform: translateY(-8px) rotate(1deg);
            border-color: var(--poster-yellow);
            box-shadow: 10px 10px 0 rgba(255, 235, 59, 0.3);
        }

        .app-icon {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 45px;
            margin-bottom: 15px;
            background: #F5F5F5;
        }

        .app-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--poster-text);
        }

        .app-desc {
            font-size: 0.95rem;
            color: #90A4AE;
        }

        /* æ¨¡æ€æ¡† (è®¾ç½®å§“å) */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .modal {
            background: white;
            padding: 30px;
            border-radius: 30px;
            text-align: center;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            border: 5px solid var(--poster-yellow);
            transform: scale(0.8);
            transition: transform 0.3s;
        }
        .modal-overlay.visible .modal { transform: scale(1); }

        .modal h2 { color: var(--poster-blue); margin-top: 0; }
        
        .input-group { margin: 20px 0; }
        
        #name-input {
            font-size: 1.5rem;
            padding: 10px;
            border: 3px solid #CFD8DC;
            border-radius: 15px;
            width: 80%;
            text-align: center;
            font-family: inherit;
            outline: none;
            color: var(--poster-blue);
        }
        #name-input:focus { border-color: var(--poster-blue); }

        .btn-save {
            background: var(--poster-green);
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 4px 0 #558B2F;
            transition: transform 0.1s;
        }
        .btn-save:active { transform: translateY(4px); box-shadow: none; }

        @media (max-width: 600px) {
            .sidebar { width: 100px; }
            .grade-item { width: 60px; height: 60px; font-size: 1rem; }
            .grade-item.active { transform: scale(1.1); }
            .content { padding: 20px; }
            .app-card:hover { transform: translateY(-2px); }
        }
    </style>
</head>
<body>

    <!-- é¡¶éƒ¨å½©æ—— -->
    <div class="bunting-container">
        <div class="flag" style="--color: #FFEB3B"></div>
        <div class="flag" style="--color: #00A1E9"></div>
        <div class="flag" style="--color: #7CB342"></div>
        <div class="flag" style="--color: #FF9800"></div>
        <div class="flag" style="--color: #E91E63"></div>
        <div class="flag" style="--color: #FFEB3B"></div>
        <div class="flag" style="--color: #00A1E9"></div>
        <div class="flag" style="--color: #7CB342"></div>
        <div class="flag" style="--color: #FF9800"></div>
        <div class="flag" style="--color: #E91E63"></div>
        <div class="flag" style="--color: #FFEB3B"></div>
        <div class="flag" style="--color: #00A1E9"></div>
    </div>

    <!-- èƒŒæ™¯æ³¢ç‚¹ -->
    <div class="bg-pattern"></div>

    <!-- å·¦ä¾§ä¾§è¾¹æ  -->
    <div class="sidebar">
        <div class="user-profile" onclick="openNameModal()">
            <div class="avatar">ğŸ˜Š</div>
            <div class="username-display" id="sidebar-name">å°æœ‹å‹</div>
        </div>
        <div class="grade-list" id="grade-list">
            <!-- JS ç”Ÿæˆ -->
        </div>
    </div>

    <!-- å³ä¾§å†…å®¹åŒº -->
    <div class="content">
        <header>
            <h1 id="page-title">ä¸€å¹´çº§</h1>
            <p class="subtitle" id="welcome-msg">æ¬¢è¿æ¥åˆ°ä½ çš„å­¦ä¹ ä¹å›­ï¼</p>
        </header>

        <div class="app-grid" id="app-grid">
            <!-- JS ç”Ÿæˆå¡ç‰‡ -->
        </div>
    </div>

    <!-- å§“åè¾“å…¥å¼¹çª— -->
    <div class="modal-overlay" id="name-modal">
        <div class="modal">
            <h2>ğŸ‘‹ å—¨ï¼åˆæ¬¡è§é¢</h2>
            <p>è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—å§ï¼š</p>
            <div class="input-group">
                <input type="text" id="name-input" placeholder="ä¾‹å¦‚ï¼šå®‰å®‰" maxlength="6">
            </div>
            <button class="btn-save" onclick="saveName()">è®°ä½æˆ‘ ğŸš€</button>
        </div>
    </div>

<script>
    // ==============================
    // é…ç½®æ•°æ®
    // ==============================
    const grades = [
        { name: "ä¸€å¹´çº§", short: "1" },
        { name: "äºŒå¹´çº§", short: "2" },
        { name: "ä¸‰å¹´çº§", short: "3" },
        { name: "å››å¹´çº§", short: "4" },
        { name: "äº”å¹´çº§", short: "5" },
        { name: "å…­å¹´çº§", short: "6" }
    ];
    
    const apps = [
        {
            id: 'math_market',
            grade: 0, // ä¸€å¹´çº§
            title: "æ£®æ—é­”æ³•é›†å¸‚",
            icon: "âš–ï¸",
            desc: "ç­‰é‡ä»£æ¢æ€ç»´è®­ç»ƒ",
            url: "balance.html",
            color: "#FFF9C4" // æ·¡é»„èƒŒæ™¯
        },
        {
            id: 'vending_machine',
            grade: 0, // ä¸€å¹´çº§
            title: "åŠ¨ç‰©å”®è´§æœº",
            icon: "ğŸª™",
            desc: "è®¤è¯†å…ƒè§’åˆ†",
            url: "vending.html",
            color: "#F8BBD0" // æ·¡ç²‰èƒŒæ™¯
        },
        {
            id: 'timezone',
            grade: 0, // ä¸€å¹´çº§
            title: "ä¸–ç•Œæ—¶é—´æ‹¼å›¾",
            icon: "ğŸŒ",
            desc: "ç†è§£ä¸–ç•Œå„åœ°æ—¶é—´",
            url: "timezone.html",
            color: "#BBDEFB" // æ·¡è“èƒŒæ™¯
        },
        {
            id: 'bear_care',
            grade: 0, // ä¸€å¹´çº§
            title: "å…»å°ç†Š",
            icon: "ğŸ§¸",
            desc: "æ²»æ„ˆç³»ç…§æ–™æ¸¸æˆ",
            url: "bear.html",
            color: "#FFE0B2"
        },
        {
            id: 'coming_soon',
            grade: 0,
            title: "å£ç®—å¤§æŒ‘æˆ˜",
            icon: "ğŸ§®",
            desc: "å¿«é€ŸåŠ å‡æ³•",
            url: "#",
            color: "#E1F5FE" // æ·¡è“èƒŒæ™¯
        },
        {
            id: 'coming_soon_2',
            grade: 1, // äºŒå¹´çº§
            title: "ä¹˜æ³•æ¶ˆæ¶ˆä¹",
            icon: "âŒ",
            desc: "ä¹ä¹ä¹˜æ³•è¡¨",
            url: "#",
            color: "#F1F8E9" // æ·¡ç»¿èƒŒæ™¯
        }
    ];

    let currentGradeIdx = 0;
    let userName = "å°æœ‹å‹";

    function init() {
        loadUser();
        renderSidebar();
        renderApps(0);
        fixIOSLinks(); // ä¿®å¤ iOS è·³è½¬
    }

    // --- ä¿®å¤ iOS Web App é“¾æ¥è·³è½¬ ---
    function fixIOSLinks() {
        if(("standalone" in window.navigator) && window.navigator.standalone){
            var c = document.querySelectorAll("a");
            for(var i=0;i<c.length;i++){
                c[i].addEventListener("click", function(event){
                    var attr = this.getAttribute("href");
                    if(attr && attr !== "#"){
                        event.preventDefault();
                        window.location = attr;
                    }
                },false);
            }
        }
    }

    // --- ç”¨æˆ·åé€»è¾‘ ---
    function loadUser() {
        const savedName = localStorage.getItem('anan_username');
        if (savedName) {
            userName = savedName;
            updateNameDisplay();
        } else {
            // é¦–æ¬¡è®¿é—®ï¼Œå»¶è¿Ÿä¸€ç‚¹å¼¹å‡º
            setTimeout(() => openNameModal(), 500);
        }
    }

    function openNameModal() {
        document.getElementById('name-modal').classList.add('visible');
        document.getElementById('name-input').value = userName === "å°æœ‹å‹" ? "" : userName;
        document.getElementById('name-input').focus();
    }

    function saveName() {
        const input = document.getElementById('name-input');
        const val = input.value.trim();
        if (val) {
            userName = val;
            localStorage.setItem('anan_username', userName);
            updateNameDisplay();
            document.getElementById('name-modal').classList.remove('visible');
        }
    }

    function updateNameDisplay() {
        document.getElementById('sidebar-name').innerText = userName;
        document.getElementById('welcome-msg').innerText = `${userName}ï¼Œå¼€å¿ƒçš„ç©å§ï¼Œhave funï¼`;
        // åŠ¨æ€æ›´æ–°ç½‘é¡µæ ‡é¢˜
        document.title = `${userName}çš„å­¦ä¹ ä¹å›­`;
    }

    // --- æ¸²æŸ“é€»è¾‘ ---
    function renderSidebar() {
        const list = document.getElementById('grade-list');
        list.innerHTML = '';
        grades.forEach((g, idx) => {
            const item = document.createElement('div');
            item.className = `grade-item ${idx === currentGradeIdx ? 'active' : ''}`;
            // ä¸¤ä¸ªspanå®ç°æ¢è¡Œæ•ˆæœï¼šæ•°å­—å¤§ï¼Œæ–‡å­—å°
            item.innerHTML = `<span><div style="font-size:1.4em">${g.short}</div><div style="font-size:0.6em">å¹´çº§</div></span>`;
            item.onclick = () => switchGrade(idx);
            list.appendChild(item);
        });
    }

    function renderApps(gradeIdx) {
        const grid = document.getElementById('app-grid');
        grid.innerHTML = '';
        
        const currentApps = apps.filter(app => app.grade === gradeIdx);

        if (currentApps.length === 0) {
            grid.innerHTML = `<div style="grid-column:1/-1; text-align:center; color:#B0BEC5; margin-top:50px;">
                <h3>ğŸš§ æ–½å·¥ä¸­...</h3>
                <p>è¿™ä¸ªå¹´çº§çš„é­”æ³•è¿˜åœ¨é…é…¿ä¸­</p>
            </div>`;
            return;
        }

        currentApps.forEach(app => {
            const card = document.createElement('a');
            card.className = 'app-card';
            card.href = app.url;
            if(app.url === '#') {
                card.onclick = (e) => { e.preventDefault(); alert('å·¥ç¨‹å¸ˆæ­£åœ¨åŠªåŠ›å¼€å‘ä¸­ï¼ğŸ—ï¸'); };
            }

            card.innerHTML = `
                <div class="app-icon" style="background-color:${app.color}">${app.icon}</div>
                <div class="app-title">${app.title}</div>
                <div class="app-desc">${app.desc}</div>
            `;
            grid.appendChild(card);
        });
    }

    function switchGrade(idx) {
        currentGradeIdx = idx;
        document.getElementById('page-title').innerText = grades[idx].name;
        renderSidebar();
        renderApps(idx);
    }

    init();

</script>
</body>
</html>
